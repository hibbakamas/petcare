{% extends 'base.html' %}
{% block title %}{{ pet.name }} · PetCare{% endblock %}

{% block content %}
<header class="grid pet-header">
  <div>
    <h1 class="pet-title">{{ pet.name }}</h1>
    {% if pet.species or pet.breed %}
      <p>{{ pet.species }}{% if pet.breed %} — {{ pet.breed }}{% endif %}</p>
    {% endif %}
  </div>
</header>

<section>
  {% if error %}<p class="error">{{ error }}</p>{% endif %}
  <form method="post" action="{{ url_for('ui.entries_create', pet_id=pet.id) }}" class="entry-form">
    <textarea name="content" rows="3" placeholder="What happened?" required></textarea>
    <div class="entry-actions">
      <button type="submit" class="button btn-sm">Add</button>
    </div>
  </form>
</section>

<section>
  <h2 class="pet-section">Entries</h2>

  <form method="get" class="controls-row" style="max-width:420px;margin:0 0 1rem 0;">
  <label>
    <select name="range">
      <option value="day"   {{ 'selected' if range=='day' else '' }}>Daily</option>
      <option value="week"  {{ 'selected' if range=='week' else '' }}>Weekly</option>
      <option value="month" {{ 'selected' if range=='month' else '' }}>Monthly</option>
      <option value="all"   {{ 'selected' if range=='all' else '' }}>All</option>
    </select>
  </label>
  <button type="submit">Filter</button>
</form>

  {% if entries %}
<ul class="entries-list" role="list">
  {% for e in entries %}
    <li>
      <span class="entry-text">
        <small>{{ e.created_at | localdt }}</small>
        — {{ members_map.get(e.user_id, "Unknown") }}: {{ e.content }}
      </span>

      <span class="entry-actions">
        {% if e.user_id == session.user_id %}
          <a class="action-inline" href="{{ url_for('ui.entries_edit_get', pet_id=pet.id, entry_id=e.id) }}">Edit</a>
          <form method="post"
                action="{{ url_for('ui.entries_delete', pet_id=pet.id, entry_id=e.id) }}"
                class="inline-form">
            <button type="submit" class="action-inline danger">Delete</button>
          </form>
        {% endif %}
      </span>
    </li>
  {% endfor %}
</ul>
  {% else %}
    <p><em>No entries yet.</em></p>
  {% endif %}
</section>
{% endblock %}